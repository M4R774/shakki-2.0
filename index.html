<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Three-Player Chess</title>
    <link rel="stylesheet" href="src/css/styles.css">
</head>
<body>
    <div class="mode-selection-menu">
        <div class="menu-content">
            <h2>Select Game Mode</h2>
            <button id="localMode" class="control-button">Local (Hotseat)</button>
            <button id="aiMode" class="control-button">Play vs AI</button>
            <button id="multiPlayerMode" class="control-button" disabled style="opacity: 0.6; cursor: not-allowed;">Online Multiplayer (Coming Soon)</button>
        </div>
    </div>

    <div class="ai-setup-menu" style="display: none;">
        <div class="menu-content">
            <h2>AI Game Setup</h2>
            <div class="setup-options">
                <label for="aiPlayerCount">Number of AI Players:</label>
                <select id="aiPlayerCount">
                    <option value="1" selected>1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                </select>
            </div>
            <button id="startAiGame" class="control-button">Start Game</button>
            <button id="backFromAiSetup" class="control-button">Back</button>
        </div>
    </div>

    <div class="multiplayer-menu" style="display: none;">
        <div class="menu-content">
            <h2>Online Multiplayer</h2>
            <div class="auth-section">
                <input type="text" id="playerName" placeholder="Enter your name" maxlength="20">
                <button id="joinGame" class="control-button">Join Game</button>
            </div>
            <div class="room-section" style="display: none;">
                <input type="text" id="roomCode" placeholder="Enter room code">
                <button id="createRoom" class="control-button">Create Room</button>
                <button id="joinRoom" class="control-button">Join Room</button>
                <button id="backToModeSelect" class="control-button">Back</button>
            </div>
            <div class="room-info" style="display: none;">
                <h3>Room: <span id="currentRoom"></span></h3>
                <div id="playerList"></div>
                <button id="startOnlineGame" class="control-button" disabled>Start Game</button>
                <button id="leaveRoom" class="control-button">Leave Room</button>
            </div>
        </div>
    </div>

    <div class="game-container" style="display: none;">
        <div class="game-header">
            <div class="turn-indicator white">Current Turn: White</div>
            <div class="controls-container">
                <div class="setup-controls">
                    <label for="playerCount">Players:</label>
                    <select id="playerCount">
                        <option value="2" selected>2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                    </select>
                    <button id="startGame" class="control-button">Start Game</button>
                </div>
                <div class="sound-controls">
                    <button class="sound-toggle control-button" title="Toggle Sound Effects">ðŸ”Š</button>
                    <button class="music-toggle control-button muted" title="Toggle Background Music">ðŸŽµ</button>
                </div>
                <button class="end-turn-button" disabled>End Turn</button>
            </div>
        </div>
        <div class="chessboard"></div>
        <div class="game-description">
            <h2>About the Game</h2>
            <p>Welcome to this unique chess variant! Each player starts with 5 pieces:</p>
            <ul>
                <li>1 King (on the edge)</li>
                <li>2 Random pieces (rook, knight, bishop, or queen) on the edge</li>
                <li>2 Pawns positioned in front of other pieces</li>
            </ul>
            <p>Game Rules:</p>
            <ul>
                <li>Players get 3 moves per turn</li>
                <li>Unused moves carry over to your next turn (max = number of your pieces)</li>
                <li>Pieces have limited vision range in fog of war</li>
                <li>Capture goodie huts to gain new pieces</li>
                <li>Eliminate other players by capturing their king</li>
            </ul>
        </div>
    </div>

    <!-- Audio elements -->
    <audio id="moveSound" preload="auto">
        <source src="sounds/move.mp3" type="audio/mpeg">
    </audio>
    <audio id="captureSound" preload="auto">
        <source src="sounds/capture.mp3" type="audio/mpeg">
    </audio>
    <audio id="turnSound" preload="auto">
        <source src="sounds/turn.mp3" type="audio/mpeg">
    </audio>
    <audio id="gameOverSound" preload="auto">
        <source src="sounds/gameover.mp3" type="audio/mpeg">
    </audio>
    <audio id="backgroundMusic" loop>
        <source src="sounds/background.mp3" type="audio/mpeg">
    </audio>
    <audio id="goodieHutSound" preload="auto">
        <source src="sounds/goodiehut.mp3" type="audio/mpeg">
    </audio>

    <script type="module" src="src/js/script.js"></script>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-analytics.js";
        import { getDatabase } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-database.js";
        import { getAuth } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-auth.js";
        import { firebaseConfig } from "./src/config/firebase.config.js";

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const database = getDatabase(app);
        const auth = getAuth(app);

        // Make Firebase instances available globally
        window.firebaseApp = app;
        window.firebaseDatabase = database;
        window.firebaseAuth = auth;
    </script>
</body>
</html>